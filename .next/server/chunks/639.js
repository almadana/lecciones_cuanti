exports.id=639,exports.ids=[639],exports.modules={9639:function(n){n.exports=function(){var n=function(n,r){var t=Array.prototype.concat,e=Array.prototype.slice,o=Object.prototype.toString;function a(r,t){var e=r>t?r:t;return n.pow(10,17-~~(n.log(e>0?e:-e)*n.LOG10E))}var u=Array.isArray||function(n){return"[object Array]"===o.call(n)};function i(n){return"[object Function]"===o.call(n)}function f(n){return"number"==typeof n&&n-n==0}function c(){return new c._init(arguments)}function l(){return 0}function s(){return 1}function m(n,r){return+(n===r)}c.fn=c.prototype,c._init=function(n){if(u(n[0]))if(u(n[0][0])){i(n[1])&&(n[0]=c.map(n[0],n[1]));for(var r=0;r<n[0].length;r++)this[r]=n[0][r];this.length=n[0].length}else this[0]=i(n[1])?c.map(n[0],n[1]):n[0],this.length=1;else if(f(n[0]))this[0]=c.seq.apply(null,n),this.length=1;else{if(n[0]instanceof c)return c(n[0].toArray());this[0]=[],this.length=1}return this},c._init.prototype=c.prototype,c._init.constructor=c,c.utils={calcRdx:a,isArray:u,isFunction:i,isNumber:f,toVector:function(n){return t.apply([],n)}},c._random_fn=n.random,c.setRandom=function(n){if("function"!=typeof n)throw TypeError("fn is not a function");c._random_fn=n},c.extend=function(n){var r,t;if(1==arguments.length){for(t in n)c[t]=n[t];return this}for(r=1;r<arguments.length;r++)for(t in arguments[r])n[t]=arguments[r][t];return n},c.rows=function(n){return n.length||1},c.cols=function(n){return n[0].length||1},c.dimensions=function(n){return{rows:c.rows(n),cols:c.cols(n)}},c.row=function(n,r){return u(r)?r.map(function(r){return c.row(n,r)}):n[r]},c.rowa=function(n,r){return c.row(n,r)},c.col=function(n,r){if(u(r)){var t=c.arange(n.length).map(function(){return Array(r.length)});return r.forEach(function(r,e){c.arange(n.length).forEach(function(o){t[o][e]=n[o][r]})}),t}for(var e=Array(n.length),o=0;o<n.length;o++)e[o]=[n[o][r]];return e},c.cola=function(n,r){return c.col(n,r).map(function(n){return n[0]})},c.diag=function(n){for(var r=c.rows(n),t=Array(r),e=0;e<r;e++)t[e]=[n[e][e]];return t},c.antidiag=function(n){for(var r=c.rows(n)-1,t=Array(r),e=0;r>=0;r--,e++)t[e]=[n[e][r]];return t},c.transpose=function(n){var r,t,e,o,a,i=[];for(u(n[0])||(n=[n]),t=n.length,e=n[0].length,a=0;a<e;a++){for(o=0,r=Array(t);o<t;o++)r[o]=n[o][a];i.push(r)}return 1===i.length?i[0]:i},c.map=function(n,r,t){var e,o,a,i,f;for(u(n[0])||(n=[n]),o=n.length,a=n[0].length,i=t?n:Array(o),e=0;e<o;e++)for(i[e]||(i[e]=Array(a)),f=0;f<a;f++)i[e][f]=r(n[e][f],e,f);return 1===i.length?i[0]:i},c.cumreduce=function(n,r,t){var e,o,a,i,f;for(u(n[0])||(n=[n]),o=n.length,a=n[0].length,i=t?n:Array(o),e=0;e<o;e++)for(i[e]||(i[e]=Array(a)),a>0&&(i[e][0]=n[e][0]),f=1;f<a;f++)i[e][f]=r(i[e][f-1],n[e][f]);return 1===i.length?i[0]:i},c.alter=function(n,r){return c.map(n,r,!0)},c.create=function(n,r,t){var e,o,a=Array(n);for(i(r)&&(t=r,r=n),e=0;e<n;e++)for(o=0,a[e]=Array(r);o<r;o++)a[e][o]=t(e,o);return a},c.zeros=function(n,r){return f(r)||(r=n),c.create(n,r,l)},c.ones=function(n,r){return f(r)||(r=n),c.create(n,r,s)},c.rand=function(n,r){return f(r)||(r=n),c.create(n,r,c._random_fn)},c.identity=function(n,r){return f(r)||(r=n),c.create(n,r,m)},c.symmetric=function(n){var r,t,e=n.length;if(n.length!==n[0].length)return!1;for(r=0;r<e;r++)for(t=0;t<e;t++)if(n[t][r]!==n[r][t])return!1;return!0},c.clear=function(n){return c.alter(n,l)},c.seq=function(n,r,t,e){i(e)||(e=!1);var o,u=[],f=a(n,r),c=(r*f-n*f)/((t-1)*f),l=n;for(o=0;l<=r&&o<t;l=(n*f+c*f*++o)/f)u.push(e?e(l,o):l);return u},c.arange=function(n,t,e){var o,a=[];if(e=e||1,r===t&&(t=n,n=0),n===t||0===e||n<t&&e<0||n>t&&e>0)return[];if(e>0)for(o=n;o<t;o+=e)a.push(o);else for(o=n;o>t;o+=e)a.push(o);return a},c.slice=function(){function n(n,t,e,o){var a,u=[],i=n.length;if(r===t&&r===e&&r===o)return c.copy(n);if(t=t||0,e=e||n.length,o=o||1,(t=t>=0?t:i+t)===(e=e>=0?e:i+e)||0===o||t<e&&o<0||t>e&&o>0)return[];if(o>0)for(a=t;a<e;a+=o)u.push(n[a]);else for(a=t;a>e;a+=o)u.push(n[a]);return u}return function(r,t){if(f((t=t||{}).row)){var e,o;if(f(t.col))return r[t.row][t.col];return n(c.rowa(r,t.row),(e=t.col||{}).start,e.end,e.step)}return f(t.col)?n(c.cola(r,t.col),(o=t.row||{}).start,o.end,o.step):(o=t.row||{},e=t.col||{},n(r,o.start,o.end,o.step).map(function(r){return n(r,e.start,e.end,e.step)}))}}(),c.sliceAssign=function(t,e,o){var a,u;if(f(e.row)){if(f(e.col))return t[e.row][e.col]=o;e.col=e.col||{},e.col.start=e.col.start||0,e.col.end=e.col.end||t[0].length,e.col.step=e.col.step||1,a=c.arange(e.col.start,n.min(t.length,e.col.end),e.col.step);var i=e.row;return a.forEach(function(n,r){t[i][n]=o[r]}),t}if(f(e.col)){e.row=e.row||{},e.row.start=e.row.start||0,e.row.end=e.row.end||t.length,e.row.step=e.row.step||1,u=c.arange(e.row.start,n.min(t[0].length,e.row.end),e.row.step);var l=e.col;return u.forEach(function(n,r){t[n][l]=o[r]}),t}return o[0].length===r&&(o=[o]),e.row.start=e.row.start||0,e.row.end=e.row.end||t.length,e.row.step=e.row.step||1,e.col.start=e.col.start||0,e.col.end=e.col.end||t[0].length,e.col.step=e.col.step||1,u=c.arange(e.row.start,n.min(t.length,e.row.end),e.row.step),a=c.arange(e.col.start,n.min(t[0].length,e.col.end),e.col.step),u.forEach(function(n,r){a.forEach(function(e,a){t[n][e]=o[r][a]})}),t},c.diagonal=function(n){var r=c.zeros(n.length,n.length);return n.forEach(function(n,t){r[t][t]=n}),r},c.copy=function(n){return n.map(function(n){return f(n)?n:n.map(function(n){return n})})};var g=c.prototype;g.length=0,g.push=Array.prototype.push,g.sort=Array.prototype.sort,g.splice=Array.prototype.splice,g.slice=Array.prototype.slice,g.toArray=function(){return this.length>1?e.call(this):e.call(this)[0]},g.map=function(n,r){return c(c.map(this,n,r))},g.cumreduce=function(n,r){return c(c.cumreduce(this,n,r))},g.alter=function(n){return c.alter(this,n),this};for(var p="transpose clear symmetric rows cols dimensions diag antidiag".split(" "),d=0;d<p.length;d++)!function(n){g[n]=function(r){var t,e=this;return r?(setTimeout(function(){r.call(e,g[n].call(e))}),this):u(t=c[n](this))?c(t):t}}(p[d]);for(var h="row col".split(" "),v=0;v<h.length;v++)!function(n){g[n]=function(r,t){var e=this;return t?(setTimeout(function(){t.call(e,g[n].call(e,r))}),this):c(c[n](this,r))}}(h[v]);for(var w="create zeros ones rand identity".split(" "),y=0;y<w.length;y++)!function(n){g[n]=function(){return c(c[n].apply(null,arguments))}}(w[y]);return c}(Math);!function(n,r){var t=n.utils.isFunction;function e(n,r){return n-r}function o(n,t,e){return r.max(t,r.min(n,e))}n.sum=function(n){for(var r=0,t=n.length;--t>=0;)r+=n[t];return r},n.sumsqrd=function(n){for(var r=0,t=n.length;--t>=0;)r+=n[t]*n[t];return r},n.sumsqerr=function(r){for(var t,e=n.mean(r),o=0,a=r.length;--a>=0;)o+=(t=r[a]-e)*t;return o},n.sumrow=function(n){for(var r=0,t=n.length;--t>=0;)r+=n[t];return r},n.product=function(n){for(var r=1,t=n.length;--t>=0;)r*=n[t];return r},n.min=function(n){for(var r=n[0],t=0;++t<n.length;)n[t]<r&&(r=n[t]);return r},n.max=function(n){for(var r=n[0],t=0;++t<n.length;)n[t]>r&&(r=n[t]);return r},n.unique=function(n){for(var r={},t=[],e=0;e<n.length;e++)r[n[e]]||(r[n[e]]=!0,t.push(n[e]));return t},n.mean=function(r){return n.sum(r)/r.length},n.meansqerr=function(r){return n.sumsqerr(r)/r.length},n.geomean=function(t){var e=t.map(r.log),o=n.mean(e);return r.exp(o)},n.median=function(n){var r=n.length,t=n.slice().sort(e);return 1&r?t[r/2|0]:(t[r/2-1]+t[r/2])/2},n.cumsum=function(r){return n.cumreduce(r,function(n,r){return n+r})},n.cumprod=function(r){return n.cumreduce(r,function(n,r){return n*r})},n.diff=function(n){var r,t=[],e=n.length;for(r=1;r<e;r++)t.push(n[r]-n[r-1]);return t},n.rank=function(n){var r,t=[],o={};for(r=0;r<n.length;r++){var a=n[r];o[a]?o[a]++:(o[a]=1,t.push(a))}var u=t.sort(e),i={},f=1;for(r=0;r<u.length;r++){var a=u[r],c=o[a],l=(f+(f+c-1))/2;i[a]=l,f+=c}return n.map(function(n){return i[n]})},n.mode=function(n){var r,t=n.length,o=n.slice().sort(e),a=1,u=0,i=0,f=[];for(r=0;r<t;r++)o[r]===o[r+1]?a++:(a>u?(f=[o[r]],u=a,i=0):a===u&&(f.push(o[r]),i++),a=1);return 0===i?f[0]:f},n.range=function(r){return n.max(r)-n.min(r)},n.variance=function(r,t){return n.sumsqerr(r)/(r.length-!!t)},n.pooledvariance=function(r){return r.reduce(function(r,t){return r+n.sumsqerr(t)},0)/(r.reduce(function(n,r){return n+r.length},0)-r.length)},n.deviation=function(r){for(var t=n.mean(r),e=r.length,o=Array(e),a=0;a<e;a++)o[a]=r[a]-t;return o},n.stdev=function(t,e){return r.sqrt(n.variance(t,e))},n.pooledstdev=function(t){return r.sqrt(n.pooledvariance(t))},n.meandev=function(t){for(var e=n.mean(t),o=[],a=t.length-1;a>=0;a--)o.push(r.abs(t[a]-e));return n.mean(o)},n.meddev=function(t){for(var e=n.median(t),o=[],a=t.length-1;a>=0;a--)o.push(r.abs(t[a]-e));return n.median(o)},n.coeffvar=function(r){return n.stdev(r)/n.mean(r)},n.quartiles=function(n){var t=n.length,o=n.slice().sort(e);return[o[r.round(t/4)-1],o[r.round(t/2)-1],o[r.round(3*t/4)-1]]},n.quantiles=function(n,t,a,u){var i,f,c,l,s,m,g=n.slice().sort(e),p=[t.length],d=n.length;for(void 0===a&&(a=3/8),void 0===u&&(u=3/8),i=0;i<t.length;i++)c=a+(f=t[i])*(1-a-u),l=d*f+c,s=r.floor(o(l,1,d-1)),m=o(l-s,0,1),p[i]=(1-m)*g[s-1]+m*g[s];return p},n.percentile=function(n,r,t){var o=n.slice().sort(e),a=r*(o.length+(t?1:-1))+ +!t,u=parseInt(a);return u+1<o.length?o[u-1]+(a-u)*(o[u]-o[u-1]):o[u-1]},n.percentileOfScore=function(n,r,t){var e,o,a=0,u=n.length,i=!1;for("strict"===t&&(i=!0),o=0;o<u;o++)e=n[o],(i&&e<r||!i&&e<=r)&&a++;return a/u},n.histogram=function(t,e){e=e||4;var o,a=n.min(t),u=(n.max(t)-a)/e,i=t.length,f=[];for(o=0;o<e;o++)f[o]=0;for(o=0;o<i;o++)f[r.min(r.floor((t[o]-a)/u),e-1)]+=1;return f},n.covariance=function(r,t){var e,o=n.mean(r),a=n.mean(t),u=r.length,i=Array(u);for(e=0;e<u;e++)i[e]=(r[e]-o)*(t[e]-a);return n.sum(i)/(u-1)},n.corrcoeff=function(r,t){return n.covariance(r,t)/n.stdev(r,1)/n.stdev(t,1)},n.spearmancoeff=function(r,t){return r=n.rank(r),t=n.rank(t),n.corrcoeff(r,t)},n.stanMoment=function(t,e){for(var o=n.mean(t),a=n.stdev(t),u=t.length,i=0,f=0;f<u;f++)i+=r.pow((t[f]-o)/a,e);return i/t.length},n.skewness=function(r){return n.stanMoment(r,3)},n.kurtosis=function(r){return n.stanMoment(r,4)-3};for(var a=n.prototype,u="cumsum cumprod".split(" "),i=0;i<u.length;i++)!function(r){a[r]=function(e,o){var u=[],i=0,f=this;if(t(e)&&(o=e,e=!1),o)return setTimeout(function(){o.call(f,a[r].call(f,e))}),this;if(this.length>1){for(f=!0===e?this:this.transpose();i<f.length;i++)u[i]=n[r](f[i]);return u}return n[r](this[0],e)}}(u[i]);for(var f="sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" "),c=0;c<f.length;c++)!function(r){a[r]=function(e,o){var u=[],i=0,f=this;if(t(e)&&(o=e,e=!1),o)return setTimeout(function(){o.call(f,a[r].call(f,e))}),this;if(this.length>1){for("sumrow"!==r&&(f=!0===e?this:this.transpose());i<f.length;i++)u[i]=n[r](f[i]);return!0===e?n[r](n.utils.toVector(u)):u}return n[r](this[0],e)}}(f[c]);for(var l="quantiles percentileOfScore".split(" "),s=0;s<l.length;s++)!function(r){a[r]=function(){var e,o=[],u=0,i=this,f=Array.prototype.slice.call(arguments);if(t(f[f.length-1])){e=f[f.length-1];var c=f.slice(0,f.length-1);return setTimeout(function(){e.call(i,a[r].apply(i,c))}),this}e=void 0;var l=function(t){return n[r].apply(i,[t].concat(f))};if(this.length>1){for(i=i.transpose();u<i.length;u++)o[u]=l(i[u]);return o}return l(this[0])}}(l[s])}(n,Math);var r=Math;n.gammaln=function(n){var t,e,o=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],u=1.000000000190015;for(e=(t=n)+5.5,e-=(n+.5)*r.log(e);o<6;o++)u+=a[o]/++t;return r.log(2.5066282746310007*u/n)-e},n.loggam=function(n){var t,e,o,a,u,i,f,c=[.08333333333333333,-.002777777777777778,7936507936507937e-19,-5952380952380952e-19,8417508417508418e-19,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(t=n,f=0,1==n||2==n)return 0;for(n<=7&&(f=r.floor(7-n),t=n+f),e=1/(t*t),o=2*r.PI,u=c[9],i=8;i>=0;i--)u*=e,u+=c[i];if(a=u/t+.5*r.log(o)+(t-.5)*r.log(t)-t,n<=7)for(i=1;i<=f;i++)a-=r.log(t-1),t-=1;return a},n.gammafn=function(n){var t,e,o,a,u=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],i=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,c=0,l=0,s=0,m=n;if(n>171.6243769536076)return 1/0;if(m<=0){if(!(a=m%1+36e-17))return 1/0;f=(1&m?-1:1)*r.PI/r.sin(r.PI*a),m=1-m}for(t=0,o=m,e=m<1?m++:(m-=c=(0|m)-1)-1;t<8;++t)s=(s+u[t])*e,l=l*e+i[t];if(a=s/l+1,o<m)a/=o;else if(o>m)for(t=0;t<c;++t)a*=m,m++;return f&&(a=f/a),a},n.gammap=function(r,t){return n.lowRegGamma(r,t)*n.gammafn(r)},n.lowRegGamma=function(t,e){var o,a=n.gammaln(t),u=t,i=1/t,f=i,c=e+1-t,l=1/1e-30,s=1/c,m=s,g=1,p=-~(8.5*r.log(t>=1?t:1/t)+.4*t+17);if(e<0||t<=0)return NaN;if(e<t+1){for(;g<=p;g++)i+=f*=e/++u;return i*r.exp(-e+t*r.log(e)-a)}for(;g<=p;g++)c+=2,m*=(s=1/(s=(o=-g*(g-t))*s+c))*(l=c+o/l);return 1-m*r.exp(-e+t*r.log(e)-a)},n.factorialln=function(r){return r<0?NaN:n.gammaln(r+1)},n.factorial=function(r){return r<0?NaN:n.gammafn(r+1)},n.combination=function(t,e){return t>170||e>170?r.exp(n.combinationln(t,e)):n.factorial(t)/n.factorial(e)/n.factorial(t-e)},n.combinationln=function(r,t){return n.factorialln(r)-n.factorialln(t)-n.factorialln(r-t)},n.permutation=function(r,t){return n.factorial(r)/n.factorial(r-t)},n.betafn=function(t,e){if(!(t<=0)&&!(e<=0))return t+e>170?r.exp(n.betaln(t,e)):n.gammafn(t)*n.gammafn(e)/n.gammafn(t+e)},n.betaln=function(r,t){return n.gammaln(r)+n.gammaln(t)-n.gammaln(r+t)},n.betacf=function(n,t,e){var o,a,u,i,f=1,c=t+e,l=t+1,s=t-1,m=1,g=1-c*n/l;for(1e-30>r.abs(g)&&(g=1e-30),i=g=1/g;f<=100&&(o=2*f,g=1+(a=f*(e-f)*n/((s+o)*(t+o)))*g,1e-30>r.abs(g)&&(g=1e-30),m=1+a/m,1e-30>r.abs(m)&&(m=1e-30),i*=(g=1/g)*m,g=1+(a=-(t+f)*(c+f)*n/((t+o)*(l+o)))*g,1e-30>r.abs(g)&&(g=1e-30),m=1+a/m,1e-30>r.abs(m)&&(m=1e-30),i*=u=(g=1/g)*m,!(3e-7>r.abs(u-1)));f++);return i},n.gammapinv=function(t,e){var o,a,u,i,f,c=0,l=e-1,s=n.gammaln(e);if(t>=1)return r.max(100,e+100*r.sqrt(e));if(t<=0)return 0;for(e>1?(i=r.log(l),f=r.exp(l*(i-1)-s),o=(2.30753+.27061*(a=r.sqrt(-2*r.log(t<.5?t:1-t))))/(1+a*(.99229+.04481*a))-a,t<.5&&(o=-o),o=r.max(.001,e*r.pow(1-1/(9*e)-o/(3*r.sqrt(e)),3))):o=t<(a=1-e*(.253+.12*e))?r.pow(t/a,1/e):1-r.log(1-(t-a)/(1-a));c<12;c++){if(o<=0)return 0;if(u=(n.lowRegGamma(e,o)-t)/(a=e>1?f*r.exp(-(o-l)+l*(r.log(o)-i)):r.exp(-o+l*r.log(o)-s)),(o-=a=u/(1-.5*r.min(1,u*((e-1)/o-1))))<=0&&(o=.5*(o+a)),r.abs(a)<1e-8*o)break}return o},n.erf=function(n){var t,e,o,a,u=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-946595344482036e-18,366839497852761e-18,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],i=u.length-1,f=!1,c=0,l=0;for(n<0&&(n=-n,f=!0),e=4*(t=2/(2+n))-2;i>0;i--)o=c,c=e*c-l+u[i],l=o;return a=t*r.exp(-n*n+.5*(u[0]+e*c)-l),f?a-1:1-a},n.erfc=function(r){return 1-n.erf(r)},n.erfcinv=function(t){var e,o,a,u,i=0;if(t>=2)return -100;if(t<=0)return 100;for(u=t<1?t:2-t,e=-.70711*((2.30753+.27061*(a=r.sqrt(-2*r.log(u/2))))/(1+a*(.99229+.04481*a))-a);i<2;i++)o=n.erfc(e)-u,e+=o/(1.1283791670955126*r.exp(-e*e)-e*o);return t<1?e:-e},n.ibetainv=function(t,e,o){var a,u,i,f,c,l,s,m,g,p=e-1,d=o-1,h=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&o>=1?(c=(2.30753+.27061*(i=r.sqrt(-2*r.log(t<.5?t:1-t))))/(1+i*(.99229+.04481*i))-i,t<.5&&(c=-c),l=(c*c-3)/6,s=2/(1/(2*e-1)+1/(2*o-1)),m=c*r.sqrt(l+s)/s-(1/(2*o-1)-1/(2*e-1))*(l+5/6-2/(3*s)),c=e/(e+o*r.exp(2*m))):(a=r.log(e/(e+o)),u=r.log(o/(e+o)),m=(i=r.exp(e*a)/e)+(f=r.exp(o*u)/o),c=t<i/m?r.pow(e*m*t,1/e):1-r.pow(o*m*(1-t),1/o)),g=-n.gammaln(e)-n.gammaln(o)+n.gammaln(e+o);h<10&&0!==c&&1!==c&&(f=(n.ibeta(c,e,o)-t)/(i=r.exp(p*r.log(c)+d*r.log(1-c)+g)),(c-=i=f/(1-.5*r.min(1,f*(p/c-d/(1-c)))))<=0&&(c=.5*(c+i)),c>=1&&(c=.5*(c+i+1)),!(r.abs(i)<1e-8*c)||!(h>0));h++);return c},n.ibeta=function(t,e,o){var a=0===t||1===t?0:r.exp(n.gammaln(e+o)-n.gammaln(e)-n.gammaln(o)+e*r.log(t)+o*r.log(1-t));return!(t<0)&&!(t>1)&&(t<(e+1)/(e+o+2)?a*n.betacf(t,e,o)/e:1-a*n.betacf(1-t,o,e)/o)},n.randn=function(t,e){var o,a,u,i,f;if(e||(e=t),t)return n.create(t,e,function(){return n.randn()});do o=n._random_fn(),a=1.7156*(n._random_fn()-.5),f=(u=o-.449871)*u+(i=r.abs(a)+.386595)*(.196*i-.25472*u);while(f>.27597&&(f>.27846||a*a>-4*r.log(o)*o*o));return a/o},n.randg=function(t,e,o){var a,u,i,f,c,l,s=t;if(o||(o=e),t||(t=1),e)return(l=n.zeros(e,o)).alter(function(){return n.randg(t)}),l;t<1&&(t+=1),a=t-1/3,u=1/r.sqrt(9*a);do{do f=1+u*(c=n.randn());while(f<=0);f=f*f*f,i=n._random_fn()}while(i>1-.331*r.pow(c,4)&&r.log(i)>.5*c*c+a*(1-f+r.log(f)));if(t==s)return a*f;do i=n._random_fn();while(0===i);return r.pow(i,1/s)*a*f};for(var t="gammaln gammafn factorial factorialln".split(" "),e=0;e<t.length;e++)!function(r){n.fn[r]=function(){return n(n.map(this,function(t){return n[r](t)}))}}(t[e]);for(var o="randn".split(" "),a=0;a<o.length;a++)!function(r){n.fn[r]=function(){return n(n[r].apply(null,arguments))}}(o[a]);for(var u=Math,i="beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" "),f=0;f<i.length;f++)!function(r){n[r]=function n(r,t,e){return this instanceof n?(this._a=r,this._b=t,this._c=e,this):new n(r,t,e)},n.fn[r]=function(t,e,o){var a=n[r](t,e,o);return a.data=this,a},n[r].prototype.sample=function(t){var e=this._a,o=this._b,a=this._c;return t?n.alter(t,function(){return n[r].sample(e,o,a)}):n[r].sample(e,o,a)};for(var t="pdf cdf inv".split(" "),e=0;e<t.length;e++)!function(t){n[r].prototype[t]=function(e){var o=this._a,a=this._b,u=this._c;return(e||0===e||(e=this.data),"number"!=typeof e)?n.fn.map.call(e,function(e){return n[r][t](e,o,a,u)}):n[r][t](e,o,a,u)}}(t[e]);for(var o="mean median mode variance".split(" "),a=0;a<o.length;a++)!function(t){n[r].prototype[t]=function(){return n[r][t](this._a,this._b,this._c)}}(o[a])}(i[f]);function c(n,r,t,e){for(var o,a=0,i=1,f=1,c=1,l=0,s=0;u.abs((f-s)/f)>e;)s=f,a=f+(o=-(r+l)*(r+t+l)*n/(r+2*l)/(r+2*l+1))*a,i=c+o*i,l+=1,f=a+(o=l*(t-l)*n/(r+2*l-1)/(r+2*l))*f,a/=c=i+o*c,i/=c,f/=c,c=1;return f/r}function l(r,t,e){var o=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],a=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],i=.5*r;if(i>=8)return 1;var f=2*n.normal.cdf(i,0,1,1,0)-1;f=f>=u.exp(-50/e)?u.pow(f,e):0;for(var c=i,l=(8-i)/(y=r>3?2:3),s=c+l,m=0,g=e-1,p=1;p<=y;p++){for(var d=0,h=.5*(s+c),v=.5*(s-c),w=1;w<=12;w++){var y,b,x=h+v*(6<w?o[(b=12-w+1)-1]:-o[(b=w)-1]),q=x*x;if(q>60)break;var _=.5*(2*n.normal.cdf(x,0,1,1,0))-.5*(2*n.normal.cdf(x,r,1,1,0));_>=u.exp(-30/g)&&(d+=_=a[b-1]*u.exp(-(.5*q))*u.pow(_,g))}d*=2*v*e/u.sqrt(2*u.PI),m+=d,c=s,s+=l}return(f+=m)<=u.exp(-30/t)?0:(f=u.pow(f,t))>=1?1:f}n.extend(n.beta,{pdf:function(r,t,e){return r>1||r<0?0:1==t&&1==e?1:t<512&&e<512?u.pow(r,t-1)*u.pow(1-r,e-1)/n.betafn(t,e):u.exp((t-1)*u.log(r)+(e-1)*u.log(1-r)-n.betaln(t,e))},cdf:function(r,t,e){return r>1||r<0?(r>1)*1:n.ibeta(r,t,e)},inv:function(r,t,e){return n.ibetainv(r,t,e)},mean:function(n,r){return n/(n+r)},median:function(r,t){return n.ibetainv(.5,r,t)},mode:function(n,r){return(n-1)/(n+r-2)},sample:function(r,t){var e=n.randg(r);return e/(e+n.randg(t))},variance:function(n,r){return n*r/(u.pow(n+r,2)*(n+r+1))}}),n.extend(n.centralF,{pdf:function(r,t,e){var o;return r<0?0:t<=2?0===r&&t<2?1/0:0===r&&2===t?1:1/n.betafn(t/2,e/2)*u.pow(t/e,t/2)*u.pow(r,t/2-1)*u.pow(1+t/e*r,-(t+e)/2):(o=e/(e+r*t),t*o/2*n.binomial.pdf((t-2)/2,(t+e-2)/2,t*r/(e+r*t)))},cdf:function(r,t,e){return r<0?0:n.ibeta(t*r/(t*r+e),t/2,e/2)},inv:function(r,t,e){return e/(t*(1/n.ibetainv(r,t/2,e/2)-1))},mean:function(n,r){return r>2?r/(r-2):void 0},mode:function(n,r){return n>2?r*(n-2)/(n*(r+2)):void 0},sample:function(r,t){return 2*n.randg(r/2)/r/(2*n.randg(t/2)/t)},variance:function(n,r){if(!(r<=4))return 2*r*r*(n+r-2)/(n*(r-2)*(r-2)*(r-4))}}),n.extend(n.cauchy,{pdf:function(n,r,t){return t<0?0:t/(u.pow(n-r,2)+u.pow(t,2))/u.PI},cdf:function(n,r,t){return u.atan((n-r)/t)/u.PI+.5},inv:function(n,r,t){return r+t*u.tan(u.PI*(n-.5))},median:function(n){return n},mode:function(n){return n},sample:function(r,t){return n.randn()*u.sqrt(1/(2*n.randg(.5)))*t+r}}),n.extend(n.chisquare,{pdf:function(r,t){return r<0?0:0===r&&2===t?.5:u.exp((t/2-1)*u.log(r)-r/2-t/2*u.log(2)-n.gammaln(t/2))},cdf:function(r,t){return r<0?0:n.lowRegGamma(t/2,r/2)},inv:function(r,t){return 2*n.gammapinv(r,.5*t)},mean:function(n){return n},median:function(n){return n*u.pow(1-2/(9*n),3)},mode:function(n){return n-2>0?n-2:0},sample:function(r){return 2*n.randg(r/2)},variance:function(n){return 2*n}}),n.extend(n.exponential,{pdf:function(n,r){return n<0?0:r*u.exp(-r*n)},cdf:function(n,r){return n<0?0:1-u.exp(-r*n)},inv:function(n,r){return-u.log(1-n)/r},mean:function(n){return 1/n},median:function(n){return 1/n*u.log(2)},mode:function(){return 0},sample:function(r){return -1/r*u.log(n._random_fn())},variance:function(n){return u.pow(n,-2)}}),n.extend(n.gamma,{pdf:function(r,t,e){return r<0?0:0===r&&1===t?1/e:u.exp((t-1)*u.log(r)-r/e-n.gammaln(t)-t*u.log(e))},cdf:function(r,t,e){return r<0?0:n.lowRegGamma(t,r/e)},inv:function(r,t,e){return n.gammapinv(r,t)*e},mean:function(n,r){return n*r},mode:function(n,r){if(n>1)return(n-1)*r},sample:function(r,t){return n.randg(r)*t},variance:function(n,r){return n*r*r}}),n.extend(n.invgamma,{pdf:function(r,t,e){return r<=0?0:u.exp(-(t+1)*u.log(r)-e/r-n.gammaln(t)+t*u.log(e))},cdf:function(r,t,e){return r<=0?0:1-n.lowRegGamma(t,e/r)},inv:function(r,t,e){return e/n.gammapinv(1-r,t)},mean:function(n,r){return n>1?r/(n-1):void 0},mode:function(n,r){return r/(n+1)},sample:function(r,t){return t/n.randg(r)},variance:function(n,r){if(!(n<=2))return r*r/((n-1)*(n-1)*(n-2))}}),n.extend(n.kumaraswamy,{pdf:function(n,r,t){return 0===n&&1===r?t:1===n&&1===t?r:u.exp(u.log(r)+u.log(t)+(r-1)*u.log(n)+(t-1)*u.log(1-u.pow(n,r)))},cdf:function(n,r,t){return n<0?0:n>1?1:1-u.pow(1-u.pow(n,r),t)},inv:function(n,r,t){return u.pow(1-u.pow(1-n,1/t),1/r)},mean:function(r,t){return t*n.gammafn(1+1/r)*n.gammafn(t)/n.gammafn(1+1/r+t)},median:function(n,r){return u.pow(1-u.pow(2,-1/r),1/n)},mode:function(n,r){if(n>=1&&r>=1&&1!==n&&1!==r)return u.pow((n-1)/(n*r-1),1/n)},variance:function(){throw Error("variance not yet implemented")}}),n.extend(n.lognormal,{pdf:function(n,r,t){return n<=0?0:u.exp(-u.log(n)-.5*u.log(2*u.PI)-u.log(t)-u.pow(u.log(n)-r,2)/(2*t*t))},cdf:function(r,t,e){return r<0?0:.5+.5*n.erf((u.log(r)-t)/u.sqrt(2*e*e))},inv:function(r,t,e){return u.exp(-1.4142135623730951*e*n.erfcinv(2*r)+t)},mean:function(n,r){return u.exp(n+r*r/2)},median:function(n){return u.exp(n)},mode:function(n,r){return u.exp(n-r*r)},sample:function(r,t){return u.exp(n.randn()*t+r)},variance:function(n,r){return(u.exp(r*r)-1)*u.exp(2*n+r*r)}}),n.extend(n.noncentralt,{pdf:function(r,t,e){return 1e-14>u.abs(e)?n.studentt.pdf(r,t):1e-14>u.abs(r)?u.exp(n.gammaln((t+1)/2)-e*e/2-.5*u.log(u.PI*t)-n.gammaln(t/2)):t/r*(n.noncentralt.cdf(r*u.sqrt(1+2/t),t+2,e)-n.noncentralt.cdf(r,t,e))},cdf:function(r,t,e){if(1e-14>u.abs(e))return n.studentt.cdf(r,t);var o=!1;r<0&&(o=!0,e=-e);for(var a=n.normal.cdf(-e,0,1),i=1e-14+1,f=1e-14+1,c=r*r/(r*r+t),l=0,s=u.exp(-e*e/2),m=u.exp(-e*e/2-.5*u.log(2)-n.gammaln(1.5))*e;l<200||f>1e-14||i>1e-14;)f=i,l>0&&(s*=e*e/(2*l),m*=e*e/(2*(l+.5))),a+=.5*(i=s*n.beta.cdf(c,l+.5,t/2)+m*n.beta.cdf(c,l+1,t/2)),l++;return o?1-a:a}}),n.extend(n.normal,{pdf:function(n,r,t){return u.exp(-.5*u.log(2*u.PI)-u.log(t)-u.pow(n-r,2)/(2*t*t))},cdf:function(r,t,e){return .5*(1+n.erf((r-t)/u.sqrt(2*e*e)))},inv:function(r,t,e){return -1.4142135623730951*e*n.erfcinv(2*r)+t},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},sample:function(r,t){return n.randn()*t+r},variance:function(n,r){return r*r}}),n.extend(n.pareto,{pdf:function(n,r,t){return n<r?0:t*u.pow(r,t)/u.pow(n,t+1)},cdf:function(n,r,t){return n<r?0:1-u.pow(r/n,t)},inv:function(n,r,t){return r/u.pow(1-n,1/t)},mean:function(n,r){if(!(r<=1))return r*u.pow(n,r)/(r-1)},median:function(n,r){return n*(r*u.SQRT2)},mode:function(n){return n},variance:function(n,r){if(!(r<=2))return n*n*r/(u.pow(r-1,2)*(r-2))}}),n.extend(n.studentt,{pdf:function(r,t){return t=t>1e100?1e100:t,1/(u.sqrt(t)*n.betafn(.5,t/2))*u.pow(1+r*r/t,-((t+1)/2))},cdf:function(r,t){var e=t/2;return n.ibeta((r+u.sqrt(r*r+t))/(2*u.sqrt(r*r+t)),e,e)},inv:function(r,t){var e=n.ibetainv(2*u.min(r,1-r),.5*t,.5);return e=u.sqrt(t*(1-e)/e),r>.5?e:-e},mean:function(n){return n>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(r){return n.randn()*u.sqrt(r/(2*n.randg(r/2)))},variance:function(n){return n>2?n/(n-2):n>1?1/0:void 0}}),n.extend(n.weibull,{pdf:function(n,r,t){return n<0||r<0||t<0?0:t/r*u.pow(n/r,t-1)*u.exp(-u.pow(n/r,t))},cdf:function(n,r,t){return n<0?0:1-u.exp(-u.pow(n/r,t))},inv:function(n,r,t){return r*u.pow(-u.log(1-n),1/t)},mean:function(r,t){return r*n.gammafn(1+1/t)},median:function(n,r){return n*u.pow(u.log(2),1/r)},mode:function(n,r){return r<=1?0:n*u.pow((r-1)/r,1/r)},sample:function(r,t){return r*u.pow(-u.log(n._random_fn()),1/t)},variance:function(r,t){return r*r*n.gammafn(1+2/t)-u.pow(n.weibull.mean(r,t),2)}}),n.extend(n.uniform,{pdf:function(n,r,t){return n<r||n>t?0:1/(t-r)},cdf:function(n,r,t){return n<r?0:n<t?(n-r)/(t-r):1},inv:function(n,r,t){return r+n*(t-r)},mean:function(n,r){return .5*(n+r)},median:function(r,t){return n.mean(r,t)},mode:function(){throw Error("mode is not yet implemented")},sample:function(r,t){return r/2+t/2+(t/2-r/2)*(2*n._random_fn()-1)},variance:function(n,r){return u.pow(r-n,2)/12}}),n.extend(n.binomial,{pdf:function(r,t,e){return 0===e||1===e?+(t*e===r):n.combination(t,r)*u.pow(e,r)*u.pow(1-e,t-r)},cdf:function(r,t,e){if(r<0)return 0;if(r>=t)return 1;if(e<0||e>1||t<=0)return NaN;var o,a=(r=u.floor(r))+1,i=t-r,f=a+i,l=u.exp(n.gammaln(f)-n.gammaln(i)-n.gammaln(a)+a*u.log(e)+i*u.log(1-e));return o=e<(a+1)/(f+2)?l*c(e,a,i,1e-10):1-l*c(1-e,i,a,1e-10),u.round(1e10*(1-o))/1e10}}),n.extend(n.negbin,{pdf:function(r,t,e){return r===r>>>0&&(r<0?0:n.combination(r+t-1,t-1)*u.pow(1-e,r)*u.pow(e,t))},cdf:function(r,t,e){var o=0,a=0;if(r<0)return 0;for(;a<=r;a++)o+=n.negbin.pdf(a,t,e);return o}}),n.extend(n.hypgeom,{pdf:function(r,t,e,o){if(r!=r|0)return!1;if(r<0||r<e-(t-o))return 0;if(r>o||r>e)return 0;if(2*e>t)if(2*o>t)return n.hypgeom.pdf(t-e-o+r,t,t-e,t-o);else return n.hypgeom.pdf(o-r,t,t-e,o);if(2*o>t)return n.hypgeom.pdf(e-r,t,e,t-o);if(e<o)return n.hypgeom.pdf(r,t,o,e);for(var a=1,i=0,f=0;f<r;f++){for(;a>1&&i<o;)a*=1-e/(t-i),i++;a*=(o-f)*(e-f)/((f+1)*(t-e-o+f+1))}for(;i<o;i++)a*=1-e/(t-i);return u.min(1,u.max(0,a))},cdf:function(r,t,e,o){if(r<0||r<e-(t-o))return 0;if(r>=o||r>=e)return 1;if(2*e>t)if(2*o>t)return n.hypgeom.cdf(t-e-o+r,t,t-e,t-o);else return 1-n.hypgeom.cdf(o-r-1,t,t-e,o);if(2*o>t)return 1-n.hypgeom.cdf(e-r-1,t,e,t-o);if(e<o)return n.hypgeom.cdf(r,t,o,e);for(var a=1,i=1,f=0,c=0;c<r;c++){for(;a>1&&f<o;){var l=1-e/(t-f);i*=l,a*=l,f++}i*=(o-c)*(e-c)/((c+1)*(t-e-o+c+1)),a+=i}for(;f<o;f++)a*=1-e/(t-f);return u.min(1,u.max(0,a))}}),n.extend(n.poisson,{pdf:function(r,t){return t<0||r%1!=0||r<0?0:u.pow(t,r)*u.exp(-t)/n.factorial(r)},cdf:function(r,t){var e=[],o=0;if(r<0)return 0;for(;o<=r;o++)e.push(n.poisson.pdf(o,t));return n.sum(e)},mean:function(n){return n},variance:function(n){return n},sampleSmall:function(r){var t=1,e=0,o=u.exp(-r);do e++,t*=n._random_fn();while(t>o);return e-1},sampleLarge:function(r){var t,e,o,a,i,f,c,l,s,m;for(a=u.sqrt(r),i=u.log(r),f=-.059+.02483*(c=.931+2.53*a),l=1.1239+1.1328/(c-3.4),s=.9277-3.6224/(c-2);;){if(e=u.random()-.5,o=u.random(),m=.5-u.abs(e),t=u.floor((2*f/m+c)*e+r+.43),m>=.07&&o<=s)return t;if(!(t<0)&&(!(m<.013)||!(o>m))&&u.log(o)+u.log(l)-u.log(f/(m*m)+c)<=-r+t*i-n.loggam(t+1))return t}},sample:function(n){return n<10?this.sampleSmall(n):this.sampleLarge(n)}}),n.extend(n.triangular,{pdf:function(n,r,t,e){return t<=r||e<r||e>t?NaN:n<r||n>t?0:n<e?2*(n-r)/((t-r)*(e-r)):n===e?2/(t-r):2*(t-n)/((t-r)*(t-e))},cdf:function(n,r,t,e){return t<=r||e<r||e>t?NaN:n<=r?0:n>=t?1:n<=e?u.pow(n-r,2)/((t-r)*(e-r)):1-u.pow(t-n,2)/((t-r)*(t-e))},inv:function(n,r,t,e){return t<=r||e<r||e>t?NaN:n<=(e-r)/(t-r)?r+(t-r)*u.sqrt((e-r)/(t-r)*n):r+(t-r)*(1-u.sqrt((1-n)*(1-(e-r)/(t-r))))},mean:function(n,r,t){return(n+r+t)/3},median:function(n,r,t){return t<=(n+r)/2?r-u.sqrt((r-n)*(r-t))/u.sqrt(2):t>(n+r)/2?n+u.sqrt((r-n)*(t-n))/u.sqrt(2):void 0},mode:function(n,r,t){return t},sample:function(r,t,e){var o=n._random_fn();return o<(e-r)/(t-r)?r+u.sqrt(o*(t-r)*(e-r)):t-u.sqrt((1-o)*(t-r)*(t-e))},variance:function(n,r,t){return(n*n+r*r+t*t-n*r-n*t-r*t)/18}}),n.extend(n.arcsine,{pdf:function(n,r,t){return t<=r?NaN:n<=r||n>=t?0:2/u.PI*u.pow(u.pow(t-r,2)-u.pow(2*n-r-t,2),-.5)},cdf:function(n,r,t){return n<r?0:n<t?2/u.PI*u.asin(u.sqrt((n-r)/(t-r))):1},inv:function(n,r,t){return r+(.5-.5*u.cos(u.PI*n))*(t-r)},mean:function(n,r){return r<=n?NaN:(n+r)/2},median:function(n,r){return r<=n?NaN:(n+r)/2},mode:function(){throw Error("mode is not yet implemented")},sample:function(r,t){return(r+t)/2+(t-r)/2*u.sin(2*u.PI*n.uniform.sample(0,1))},variance:function(n,r){return r<=n?NaN:u.pow(r-n,2)/8}}),n.extend(n.laplace,{pdf:function(n,r,t){return t<=0?0:u.exp(-u.abs(n-r)/t)/(2*t)},cdf:function(n,r,t){return t<=0?0:n<r?.5*u.exp((n-r)/t):1-.5*u.exp(-(n-r)/t)},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},variance:function(n,r){return 2*r*r},sample:function(r,t){var e=n._random_fn()-.5;return r-t*(e/u.abs(e))*u.log(1-2*u.abs(e))}}),n.extend(n.tukey,{cdf:function(r,t,e){var o=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],a=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(r<=0)return 0;if(e<2||t<2)return NaN;if(!Number.isFinite(r))return 1;if(e>25e3)return l(r,1,t);var i=.5*e,f=i*u.log(e)-e*u.log(2)-n.gammaln(i),c=i-1,s=.25*e;p=e<=100?1:e<=800?.5:e<=5e3?.25:.125,f+=u.log(p);for(var m=0,g=1;g<=50;g++){for(var p,d,h,v=0,w=(2*g-1)*p,y=1;y<=16;y++)if(8<y?(d=y-8-1,h=f+c*u.log(w+o[d]*p)-(o[d]*p+w)*s):(d=y-1,h=f+c*u.log(w-o[d]*p)+(o[d]*p-w)*s),h>=-30){v+=l(8<y?r*u.sqrt((o[d]*p+w)*.5):r*u.sqrt((-(o[d]*p)+w)*.5),1,t)*a[d]*u.exp(h)}if(g*p>=1&&v<=1e-14)break;m+=v}if(v>1e-14)throw Error("tukey.cdf failed to converge");return m>1&&(m=1),m},inv:function(r,t,e){if(e<2||t<2||r<0||r>1)return NaN;if(0===r)return 0;if(1===r)return 1/0;var o,a,i,f,c,l,s=(i=.5-.5*r,c=(f=u.sqrt(u.log(1/(i*i))))+((((-453642210148e-16*f+-.204231210125)*f+-.342242088547)*f+-1)*f+.322232421088)/((((.0038560700634*f+.10353775285)*f+.531103462366)*f+.588581570495)*f+.099348462606),e<120&&(c+=(c*c*c+c)/e/4),l=.8832-.2368*c,e<120&&(l+=-1.214/e+1.208*c/e),c*(l*u.log(t-1)+1.4142)),m=n.tukey.cdf(s,t,e)-r;o=m>0?u.max(0,s-1):s+1;for(var g=n.tukey.cdf(o,t,e)-r,p=1;p<50;p++)if(a=o-g*(o-s)/(g-m),m=g,s=o,a<0&&(a=0,g=-r),g=n.tukey.cdf(a,t,e)-r,o=a,1e-4>u.abs(o-s))return a;throw Error("tukey.inv failed to converge")}}),function(n,r){var t,e,o=Array.prototype.push,a=n.utils.isArray;function u(r){return a(r)||r instanceof n}n.extend({add:function(r,t){return u(t)?(u(t[0])||(t=[t]),n.map(r,function(n,r,e){return n+t[r][e]})):n.map(r,function(n){return n+t})},subtract:function(r,t){return u(t)?(u(t[0])||(t=[t]),n.map(r,function(n,r,e){return n-t[r][e]||0})):n.map(r,function(n){return n-t})},divide:function(r,t){return u(t)?(u(t[0])||(t=[t]),n.multiply(r,n.inv(t))):n.map(r,function(n){return n/t})},multiply:function(r,t){var e,o,a,i,f,c,l,s;if(void 0===r.length&&void 0===t.length)return r*t;if(f=r.length,c=r[0].length,l=n.zeros(f,a=u(t)?t[0].length:c),s=0,u(t)){for(;s<a;s++)for(e=0;e<f;e++){for(o=0,i=0;o<c;o++)i+=r[e][o]*t[o][s];l[e][s]=i}return 1===f&&1===s?l[0][0]:l}return n.map(r,function(n){return n*t})},outer:function(r,t){return n.multiply(r.map(function(n){return[n]}),[t])},dot:function(r,t){u(r[0])||(r=[r]),u(t[0])||(t=[t]);for(var e,o,a=1===r[0].length&&1!==r.length?n.transpose(r):r,i=1===t[0].length&&1!==t.length?n.transpose(t):t,f=[],c=0,l=a.length,s=a[0].length;c<l;c++){for(o=0,f[c]=[],e=0;o<s;o++)e+=a[c][o]*i[c][o];f[c]=e}return 1===f.length?f[0]:f},pow:function(t,e){return n.map(t,function(n){return r.pow(n,e)})},exp:function(t){return n.map(t,function(n){return r.exp(n)})},log:function(t){return n.map(t,function(n){return r.log(n)})},abs:function(t){return n.map(t,function(n){return r.abs(n)})},norm:function(n,t){var e=0,o=0;for(isNaN(t)&&(t=2),u(n[0])&&(n=n[0]);o<n.length;o++)e+=r.pow(r.abs(n[o]),t);return r.pow(e,1/t)},angle:function(t,e){return r.acos(n.dot(t,e)/(n.norm(t)*n.norm(e)))},aug:function(n,r){var t,e=[];for(t=0;t<n.length;t++)e.push(n[t].slice());for(t=0;t<e.length;t++)o.apply(e[t],r[t]);return e},inv:function(r){for(var t,e=r.length,o=r[0].length,a=n.identity(e,o),u=n.gauss_jordan(r,a),i=[],f=0;f<e;f++)for(i[f]=[],t=o;t<u[0].length;t++)i[f][t-o]=u[f][t];return i},det:function n(r){if(2===r.length)return r[0][0]*r[1][1]-r[0][1]*r[1][0];for(var t=0,e=0;e<r.length;e++){for(var o=[],a=1;a<r.length;a++){o[a-1]=[];for(var u=0;u<r.length;u++)u<e?o[a-1][u]=r[a][u]:u>e&&(o[a-1][u-1]=r[a][u])}var i=e%2?-1:1;t+=n(o)*r[0][e]*i}return t},gauss_elimination:function(t,e){var o,a,u,i,f=0,c=0,l=t.length,s=t[0].length,m=1,g=0,p=[];for(f=0,o=(t=n.aug(t,e))[0].length;f<l;f++){for(a=t[f][f],c=f,i=f+1;i<s;i++)a<r.abs(t[i][f])&&(a=t[i][f],c=i);if(c!=f)for(i=0;i<o;i++)u=t[f][i],t[f][i]=t[c][i],t[c][i]=u;for(c=f+1;c<l;c++)for(m=t[c][f]/t[f][f],i=f;i<o;i++)t[c][i]=t[c][i]-m*t[f][i]}for(f=l-1;f>=0;f--){for(g=0,c=f+1;c<=l-1;c++)g+=p[c]*t[f][c];p[f]=(t[f][o-1]-g)/t[f][f]}return p},gauss_jordan:function(t,e){var o,a,u,i=n.aug(t,e),f=i.length,c=i[0].length,l=0;for(a=0;a<f;a++){var s=a;for(u=a+1;u<f;u++)r.abs(i[u][a])>r.abs(i[s][a])&&(s=u);var m=i[a];for(i[a]=i[s],i[s]=m,u=a+1;u<f;u++)for(l=i[u][a]/i[a][a],o=a;o<c;o++)i[u][o]-=i[a][o]*l}for(a=f-1;a>=0;a--){for(u=0,l=i[a][a];u<a;u++)for(o=c-1;o>a-1;o--)i[u][o]-=i[a][o]*i[u][a]/l;for(i[a][a]/=l,o=f;o<c;o++)i[a][o]/=l}return i},triaUpSolve:function(r,t){var e,o=r[0].length,a=n.zeros(1,o)[0],u=!1;return(void 0!=t[0].length&&(t=t.map(function(n){return n[0]}),u=!0),n.arange(o-1,-1,-1).forEach(function(u){e=n.arange(u+1,o).map(function(n){return a[n]*r[u][n]}),a[u]=(t[u]-n.sum(e))/r[u][u]}),u)?a.map(function(n){return[n]}):a},triaLowSolve:function(r,t){var e,o=r[0].length,a=n.zeros(1,o)[0],u=!1;return(void 0!=t[0].length&&(t=t.map(function(n){return n[0]}),u=!0),n.arange(o).forEach(function(o){e=n.arange(o).map(function(n){return r[o][n]*a[n]}),a[o]=(t[o]-n.sum(e))/r[o][o]}),u)?a.map(function(n){return[n]}):a},lu:function(r){var t,e=r.length,o=n.identity(e),a=n.zeros(r.length,r[0].length);return n.arange(e).forEach(function(n){a[0][n]=r[0][n]}),n.arange(1,e).forEach(function(u){n.arange(u).forEach(function(e){t=n.arange(e).map(function(n){return o[u][n]*a[n][e]}),o[u][e]=(r[u][e]-n.sum(t))/a[e][e]}),n.arange(u,e).forEach(function(e){t=n.arange(u).map(function(n){return o[u][n]*a[n][e]}),a[u][e]=r[t.length][e]-n.sum(t)})}),[o,a]},cholesky:function(t){var e,o=t.length,a=n.zeros(t.length,t[0].length);return n.arange(o).forEach(function(u){e=n.arange(u).map(function(n){return r.pow(a[u][n],2)}),a[u][u]=r.sqrt(t[u][u]-n.sum(e)),n.arange(u+1,o).forEach(function(r){e=n.arange(u).map(function(n){return a[u][n]*a[r][n]}),a[r][u]=(t[u][r]-n.sum(e))/a[u][u]})}),a},gauss_jacobi:function(t,e,o,a){for(var u,i,f,c,l=0,s=0,m=t.length,g=[],p=[],d=[];l<m;l++)for(s=0,g[l]=[],p[l]=[],d[l]=[];s<m;s++)l>s?(g[l][s]=t[l][s],p[l][s]=d[l][s]=0):l<s?(p[l][s]=t[l][s],g[l][s]=d[l][s]=0):(d[l][s]=t[l][s],g[l][s]=p[l][s]=0);for(f=n.multiply(n.multiply(n.inv(d),n.add(g,p)),-1),i=n.multiply(n.inv(d),e),u=o,c=n.add(n.multiply(f,o),i),l=2;r.abs(n.norm(n.subtract(c,u)))>a;)u=c,c=n.add(n.multiply(f,u),i),l++;return c},gauss_seidel:function(t,e,o,a){for(var u,i,f,c,l,s=0,m=t.length,g=[],p=[],d=[];s<m;s++)for(u=0,g[s]=[],p[s]=[],d[s]=[];u<m;u++)s>u?(g[s][u]=t[s][u],p[s][u]=d[s][u]=0):s<u?(p[s][u]=t[s][u],g[s][u]=d[s][u]=0):(d[s][u]=t[s][u],g[s][u]=p[s][u]=0);for(c=n.multiply(n.multiply(n.inv(n.add(d,g)),p),-1),f=n.multiply(n.inv(n.add(d,g)),e),i=o,l=n.add(n.multiply(c,o),f),s=2;r.abs(n.norm(n.subtract(l,i)))>a;)i=l,l=n.add(n.multiply(c,i),f),s+=1;return l},SOR:function(t,e,o,a,u){for(var i,f,c,l,s,m=0,g=t.length,p=[],d=[],h=[];m<g;m++)for(i=0,p[m]=[],d[m]=[],h[m]=[];i<g;i++)m>i?(p[m][i]=t[m][i],d[m][i]=h[m][i]=0):m<i?(d[m][i]=t[m][i],p[m][i]=h[m][i]=0):(h[m][i]=t[m][i],p[m][i]=d[m][i]=0);for(l=n.multiply(n.inv(n.add(h,n.multiply(p,u))),n.subtract(n.multiply(h,1-u),n.multiply(d,u))),c=n.multiply(n.multiply(n.inv(n.add(h,n.multiply(p,u))),e),u),f=o,s=n.add(n.multiply(l,o),c),m=2;r.abs(n.norm(n.subtract(s,f)))>a;)f=s,s=n.add(n.multiply(l,f),c),m++;return s},householder:function(t){for(var e,o,a,u,i=t.length,f=t[0].length,c=0,l=[],s=[];c<i-1;c++){for(e=0,u=c+1;u<f;u++)e+=t[u][c]*t[u][c];for(e=(t[c+1][c]>0?-1:1)*r.sqrt(e),o=r.sqrt((e*e-t[c+1][c]*e)/2),(l=n.zeros(i,1))[c+1][0]=(t[c+1][c]-e)/(2*o),a=c+2;a<i;a++)l[a][0]=t[a][c]/(2*o);s=n.subtract(n.identity(i,f),n.multiply(n.multiply(l,n.transpose(l)),2)),t=n.multiply(s,n.multiply(t,s))}return t},QR:(t=n.sum,e=n.arange,function(o){var a,u,i,f=o.length,c=o[0].length,l=n.zeros(c,c);for(u=0,o=n.copy(o);u<c;u++){for(a=0,l[u][u]=r.sqrt(t(e(f).map(function(n){return o[n][u]*o[n][u]})));a<f;a++)o[a][u]=o[a][u]/l[u][u];for(i=u+1;i<c;i++)for(a=0,l[u][i]=t(e(f).map(function(n){return o[n][u]*o[n][i]}));a<f;a++)o[a][i]=o[a][i]-o[a][u]*l[u][i]}return[o,l]}),lstsq:function(r,t){var e,o,a,u=!1;void 0===t[0].length&&(t=t.map(function(n){return[n]}),u=!0);var i=n.QR(r),f=i[0],c=i[1],l=r[0].length,s=n.slice(f,{col:{end:l}}),m=(e=n.slice(c,{row:{end:l}}),o=(e=n.copy(e)).length,a=n.identity(o),n.arange(o-1,-1,-1).forEach(function(r){n.sliceAssign(a,{row:r},n.divide(n.slice(a,{row:r}),e[r][r])),n.sliceAssign(e,{row:r},n.divide(n.slice(e,{row:r}),e[r][r])),n.arange(r).forEach(function(t){var o=n.multiply(e[t][r],-1),u=n.slice(e,{row:t}),i=n.multiply(n.slice(e,{row:r}),o);n.sliceAssign(e,{row:t},n.add(u,i));var f=n.slice(a,{row:t}),c=n.multiply(n.slice(a,{row:r}),o);n.sliceAssign(a,{row:t},n.add(f,c))})}),a),g=n.transpose(s);void 0===g[0].length&&(g=[g]);var p=n.multiply(n.multiply(m,g),t);return(void 0===p.length&&(p=[[p]]),u)?p.map(function(n){return n[0]}):p},jacobi:function(t){for(var e,o,a,u,i,f,c,l=1,s=t.length,m=n.identity(s,s),g=[];1===l;){for(e=0,i=t[0][1],a=0,u=1;e<s;e++)for(o=0;o<s;o++)e!=o&&i<r.abs(t[e][o])&&(i=r.abs(t[e][o]),a=e,u=o);for(e=1,f=t[a][a]===t[u][u]?t[a][u]>0?r.PI/4:-r.PI/4:r.atan(2*t[a][u]/(t[a][a]-t[u][u]))/2,(c=n.identity(s,s))[a][a]=r.cos(f),c[a][u]=-r.sin(f),c[u][a]=r.sin(f),c[u][u]=r.cos(f),m=n.multiply(m,c),t=n.multiply(n.multiply(n.inv(c),t),c),l=0;e<s;e++)for(o=1;o<s;o++)e!=o&&r.abs(t[e][o])>.001&&(l=1)}for(e=0;e<s;e++)g.push(t[e][e]);return[m,g]},rungekutta:function(n,r,t,e,o,a){var u,i,f,c,l;if(2===a)for(;e<=t;)u=r*n(e,o),i=r*n(e+r,o+u),o+=(u+i)/2,e+=r;if(4===a)for(;e<=t;)u=r*n(e,o),i=r*n(e+r/2,o+u/2),c=r*n(e+r/2,o+i/2),l=r*n(e+r,o+c),o+=(u+2*i+2*c+l)/6,e+=r;return o},romberg:function(n,t,e,o){for(var a,u,i,f,c,l=0,s=(e-t)/2,m=[],g=[],p=[];l<o/2;){for(c=n(t),i=t,f=0;i<=e;i+=s,f++)m[f]=i;for(i=1,a=m.length;i<a-1;i++)c+=(i%2!=0?4:2)*n(m[i]);c=s/3*(c+n(e)),p[l]=c,s/=2,l++}for(u=p.length,a=1;1!==u;){for(i=0;i<u-1;i++)g[i]=(r.pow(4,a)*p[i+1]-p[i])/(r.pow(4,a)-1);u=g.length,p=g,g=[],a++}return p},richardson:function(n,t,e,o){function a(n,r){for(var t,e=0,o=n.length;e<o;e++)n[e]===r&&(t=e);return t}for(var u,i,f,c,l,s=r.abs(e-n[a(n,e)+1]),m=0,g=[],p=[];o>=s;)u=a(n,e+o),i=a(n,e),g[m]=(t[u]-2*t[i]+t[2*i-u])/(o*o),o/=2,m++;for(c=g.length,f=1;1!=c;){for(l=0;l<c-1;l++)p[l]=(r.pow(4,f)*g[l+1]-g[l])/(r.pow(4,f)-1);c=p.length,g=p,p=[],f++}return g},simpson:function(n,r,t,e){for(var o,a=(t-r)/e,u=n(r),i=[],f=r,c=0,l=1;f<=t;f+=a,c++)i[c]=f;for(o=i.length;l<o-1;l++)u+=(l%2!=0?4:2)*n(i[l]);return a/3*(u+n(t))},hermite:function(n,r,t,e){for(var o,a=n.length,u=0,i=0,f=[],c=[],l=[],s=[];i<a;i++){for(o=0,f[i]=1;o<a;o++)i!=o&&(f[i]*=(e-n[o])/(n[i]-n[o]));for(o=0,c[i]=0;o<a;o++)i!=o&&(c[i]+=1/(n[i]-n[o]));l[i]=(1-2*(e-n[i])*c[i])*(f[i]*f[i]),s[i]=(e-n[i])*(f[i]*f[i]),u+=l[i]*r[i]+s[i]*t[i]}return u},lagrange:function(n,r,t){for(var e,o,a=0,u=0,i=n.length;u<i;u++){for(e=0,o=r[u];e<i;e++)u!=e&&(o*=(t-n[e])/(n[u]-n[e]));a+=o}return a},cubic_spline:function(r,t,e){for(var o,a=r.length,u=0,i=[],f=[],c=[],l=[],s=[],m=[],g=[];u<a-1;u++)s[u]=r[u+1]-r[u];for(u=1,c[0]=0;u<a-1;u++)c[u]=3/s[u]*(t[u+1]-t[u])-3/s[u-1]*(t[u]-t[u-1]);for(u=1;u<a-1;u++)i[u]=[],f[u]=[],i[u][u-1]=s[u-1],i[u][u]=2*(s[u-1]+s[u]),i[u][u+1]=s[u],f[u][0]=c[u];for(o=0,l=n.multiply(n.inv(i),f);o<a-1;o++)m[o]=(t[o+1]-t[o])/s[o]-s[o]*(l[o+1][0]+2*l[o][0])/3,g[o]=(l[o+1][0]-l[o][0])/(3*s[o]);for(o=0;o<a&&!(r[o]>e);o++);return t[o-=1]+(e-r[o])*m[o]+n.sq(e-r[o])*l[o]+(e-r[o])*n.sq(e-r[o])*g[o]},gauss_quadrature:function(){throw Error("gauss_quadrature not yet implemented")},PCA:function(r){var t,e,o=r.length,a=r[0].length,u=0,i=[],f=[],c=[],l=[],s=[],m=[],g=[],p=[],d=[],h=[];for(u=0;u<o;u++)i[u]=n.sum(r[u])/a;for(u=0;u<a;u++)for(t=0,g[u]=[];t<o;t++)g[u][t]=r[t][u]-i[t];for(u=0,g=n.transpose(g);u<o;u++)for(t=0,p[u]=[];t<o;t++)p[u][t]=n.dot([g[u]],[g[t]])/(a-1);for(u=0,d=(c=n.jacobi(p))[0],f=c[1],h=n.transpose(d);u<f.length;u++)for(t=u;t<f.length;t++)f[u]<f[t]&&(e=f[u],f[u]=f[t],f[t]=e,l=h[u],h[u]=h[t],h[t]=l);for(u=0,m=n.transpose(g);u<o;u++)for(t=0,s[u]=[];t<m.length;t++)s[u][t]=n.dot([h[u]],[m[t]]);return[r,f,h,s]}});for(var i="add divide multiply subtract dot pow exp log abs norm angle".split(" "),f=0;f<i.length;f++)!function(r){n.fn[r]=function(t,e){var o=this;return e?(setTimeout(function(){e.call(o,n.fn[r].call(o,t))},15),this):"number"==typeof n[r](this,t)?n[r](this,t):n(n[r](this,t))}}(i[f])}(n,Math);var s=Math,m=[].slice,g=n.utils.isNumber,p=n.utils.isArray;function d(n,r,t,e){if(n>1||t>1||n<=0||t<=0)throw Error("Proportions should be greater than 0 and less than 1");var o=(n*r+t*e)/(r+e);return(n-t)/s.sqrt(o*(1-o)*(1/r+1/e))}return n.extend({zscore:function(){var r=m.call(arguments);return g(r[1])?(r[0]-r[1])/r[2]:(r[0]-n.mean(r[1]))/n.stdev(r[1],r[2])},ztest:function(){var r,t=m.call(arguments);return p(t[1])?(r=n.zscore(t[0],t[1],t[3]),1===t[2]?n.normal.cdf(-s.abs(r),0,1):2*n.normal.cdf(-s.abs(r),0,1)):t.length>2?(r=n.zscore(t[0],t[1],t[2]),1===t[3]?n.normal.cdf(-s.abs(r),0,1):2*n.normal.cdf(-s.abs(r),0,1)):(r=t[0],1===t[1]?n.normal.cdf(-s.abs(r),0,1):2*n.normal.cdf(-s.abs(r),0,1))}}),n.extend(n.fn,{zscore:function(n,r){return(n-this.mean())/this.stdev(r)},ztest:function(r,t,e){var o=s.abs(this.zscore(r,e));return 1===t?n.normal.cdf(-o,0,1):2*n.normal.cdf(-o,0,1)}}),n.extend({tscore:function(){var r=m.call(arguments);return 4===r.length?(r[0]-r[1])/(r[2]/s.sqrt(r[3])):(r[0]-n.mean(r[1]))/(n.stdev(r[1],!0)/s.sqrt(r[1].length))},ttest:function(){var r,t=m.call(arguments);return 5===t.length?(r=s.abs(n.tscore(t[0],t[1],t[2],t[3])),1===t[4]?n.studentt.cdf(-r,t[3]-1):2*n.studentt.cdf(-r,t[3]-1)):g(t[1])?(r=s.abs(t[0]),1==t[2]?n.studentt.cdf(-r,t[1]-1):2*n.studentt.cdf(-r,t[1]-1)):(r=s.abs(n.tscore(t[0],t[1])),1==t[2]?n.studentt.cdf(-r,t[1].length-1):2*n.studentt.cdf(-r,t[1].length-1))}}),n.extend(n.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/s.sqrt(this.cols()))},ttest:function(r,t){return 1===t?1-n.studentt.cdf(s.abs(this.tscore(r)),this.cols()-1):2*n.studentt.cdf(-s.abs(this.tscore(r)),this.cols()-1)}}),n.extend({anovafscore:function(){var r,t,e,o,a,u,i,f,c=m.call(arguments);if(1===c.length){for(i=0,a=Array(c[0].length);i<c[0].length;i++)a[i]=c[0][i];c=a}for(i=0,t=[];i<c.length;i++)t=t.concat(c[i]);for(i=0,e=n.mean(t),r=0;i<c.length;i++)r+=c[i].length*s.pow(n.mean(c[i])-e,2);for(r/=c.length-1,u=0,i=0;i<c.length;i++)for(f=0,o=n.mean(c[i]);f<c[i].length;f++)u+=s.pow(c[i][f]-o,2);return r/(u/=t.length-c.length)},anovaftest:function(){var r,t,e,o,a=m.call(arguments);if(g(a[0]))return 1-n.centralF.cdf(a[0],a[1],a[2]);var u=n.anovafscore(a);for(o=0,r=a.length-1,e=0;o<a.length;o++)e+=a[o].length;return t=e-r-1,1-n.centralF.cdf(u,r,t)},ftest:function(r,t,e){return 1-n.centralF.cdf(r,t,e)}}),n.extend(n.fn,{anovafscore:function(){return n.anovafscore(this.toArray())},anovaftes:function(){var r,t=0;for(r=0;r<this.length;r++)t+=this[r].length;return n.ftest(this.anovafscore(),this.length-1,t-this.length)}}),n.extend({qscore:function(){var r,t,e,o,a,u=m.call(arguments);return g(u[0])?(r=u[0],t=u[1],e=u[2],o=u[3],a=u[4]):(r=n.mean(u[0]),t=n.mean(u[1]),e=u[0].length,o=u[1].length,a=u[2]),s.abs(r-t)/(a*s.sqrt((1/e+1/o)/2))},qtest:function(){var r,t=m.call(arguments);3===t.length?(r=t[0],t=t.slice(1)):7===t.length?(r=n.qscore(t[0],t[1],t[2],t[3],t[4]),t=t.slice(5)):(r=n.qscore(t[0],t[1],t[2]),t=t.slice(3));var e=t[0],o=t[1];return 1-n.tukey.cdf(r,o,e-o)},tukeyhsd:function(r){for(var t=n.pooledstdev(r),e=r.map(function(r){return n.mean(r)}),o=r.reduce(function(n,r){return n+r.length},0),a=[],u=0;u<r.length;++u)for(var i=u+1;i<r.length;++i){var f=n.qtest(e[u],e[i],r[u].length,r[i].length,t,o,r.length);a.push([[u,i],f])}return a}}),n.extend({normalci:function(){var r,t=m.call(arguments),e=[,,];return r=4===t.length?s.abs(n.normal.inv(t[1]/2,0,1)*t[2]/s.sqrt(t[3])):s.abs(n.normal.inv(t[1]/2,0,1)*n.stdev(t[2])/s.sqrt(t[2].length)),e[0]=t[0]-r,e[1]=t[0]+r,e},tci:function(){var r,t=m.call(arguments),e=[,,];return r=4===t.length?s.abs(n.studentt.inv(t[1]/2,t[3]-1)*t[2]/s.sqrt(t[3])):s.abs(n.studentt.inv(t[1]/2,t[2].length-1)*n.stdev(t[2],!0)/s.sqrt(t[2].length)),e[0]=t[0]-r,e[1]=t[0]+r,e},significant:function(n,r){return n<r}}),n.extend(n.fn,{normalci:function(r,t){return n.normalci(r,t,this.toArray())},tci:function(r,t){return n.tci(r,t,this.toArray())}}),n.extend(n.fn,{oneSidedDifferenceOfProportions:function(r,t,e,o){var a=d(r,t,e,o);return n.ztest(a,1)},twoSidedDifferenceOfProportions:function(r,t,e,o){var a=d(r,t,e,o);return n.ztest(a,2)}}),n.models=function(){function r(r,t){var e=r.length,o=t[0].length-1,a=n.lstsq(t,r),u=n.multiply(t,a.map(function(n){return[n]})).map(function(n){return n[0]}),i=n.subtract(r,u),f=n.mean(r),c=n.sum(u.map(function(n){return Math.pow(n-f,2)})),l=n.sum(r.map(function(n,r){return Math.pow(n-u[r],2)})),s=c+l;return{exog:t,endog:r,nobs:e,df_model:o,df_resid:e-o-1,coef:a,predict:u,resid:i,ybar:f,SST:s,SSE:c,SSR:l,R2:c/s}}return{ols:function(t,e){var o,a,u,i,f,c,l,s,m,g,p,d,h,v,w=r(t,e),y=(a=(o=w.exog)[0].length,u=n.arange(a).map(function(t){var e=n.arange(a).filter(function(n){return n!==t});return r(n.col(o,t).map(function(n){return n[0]}),n.col(o,e))}),i=Math.sqrt(w.SSR/w.df_resid),f=u.map(function(n){return i/Math.sqrt(n.SST*(1-n.R2))}),l=(c=w.coef.map(function(n,r){return(n-0)/f[r]})).map(function(r){var t=n.studentt.cdf(r,w.df_resid);return(t>.5?1-t:t)*2}),s=n.studentt.inv(.975,w.df_resid),m=w.coef.map(function(n,r){var t=s*f[r];return[n-t,n+t]}),{se:f,t:c,p:l,sigmaHat:i,interval95:m}),b=(v=1-(p=g=w.R2/w.df_model/((1-w.R2)/w.df_resid),d=w.df_model,h=w.df_resid,n.beta.cdf(p/(h/d+p),d/2,h/2)),{F_statistic:g,pvalue:v}),x=1-(1-w.R2)*((w.nobs-1)/w.df_resid);return w.t=y,w.f=b,w.adjust_R2=x,w}}}(),n.extend({buildxmatrix:function(){for(var r=Array(arguments.length),t=0;t<arguments.length;t++){var e=[1];r[t]=e.concat(arguments[t])}return n(r)},builddxmatrix:function(){for(var r=Array(arguments[0].length),t=0;t<arguments[0].length;t++){var e=[1];r[t]=e.concat(arguments[0][t])}return n(r)},buildjxmatrix:function(r){for(var t=Array(r.length),e=0;e<r.length;e++)t[e]=r[e];return n.builddxmatrix(t)},buildymatrix:function(r){return n(r).transpose()},buildjymatrix:function(n){return n.transpose()},matrixmult:function(r,t){var e,o,a,u,i;if(r.cols()==t.rows()){if(t.rows()>1){for(e=0,u=[];e<r.rows();e++)for(o=0,u[e]=[];o<t.cols();o++){for(a=0,i=0;a<r.cols();a++)i+=r.toArray()[e][a]*t.toArray()[a][o];u[e][o]=i}return n(u)}for(e=0,u=[];e<r.rows();e++)for(o=0,u[e]=[];o<t.cols();o++){for(a=0,i=0;a<r.cols();a++)i+=r.toArray()[e][a]*t.toArray()[o];u[e][o]=i}return n(u)}},regress:function(r,t){var e=n.xtranspxinv(r),o=r.transpose(),a=n.matrixmult(n(e),o);return n.matrixmult(a,t)},regresst:function(r,t,e){var o,a,u,i=n.regress(r,t),f={};f.anova={};var c=n.jMatYBar(r,i);f.yBar=c;var l=t.mean();f.anova.residuals=n.residuals(t,c),f.anova.ssr=n.ssr(c,l),f.anova.msr=f.anova.ssr/(r[0].length-1),f.anova.sse=n.sse(t,c),f.anova.mse=f.anova.sse/(t.length-(r[0].length-1)-1),f.anova.sst=n.sst(t,l),f.anova.mst=f.anova.sst/(t.length-1),f.anova.r2=1-f.anova.sse/f.anova.sst,f.anova.r2<0&&(f.anova.r2=0),f.anova.fratio=f.anova.msr/f.anova.mse,f.anova.pvalue=n.anovaftest(f.anova.fratio,r[0].length-1,t.length-(r[0].length-1)-1),f.anova.rmse=Math.sqrt(f.anova.mse),f.anova.r2adj=1-f.anova.mse/f.anova.mst,f.anova.r2adj<0&&(f.anova.r2adj=0),f.stats=Array(r[0].length);for(var s=n.xtranspxinv(r),m=0;m<i.length;m++)o=Math.sqrt(f.anova.mse*Math.abs(s[m][m])),a=Math.abs(i[m]/o),u=n.ttest(a,t.length-r[0].length-1,e),f.stats[m]=[i[m],o,a,u];return f.regress=i,f},xtranspx:function(r){return n.matrixmult(r.transpose(),r)},xtranspxinv:function(r){var t=n.matrixmult(r.transpose(),r);return n.inv(t)},jMatYBar:function(r,t){var e=n.matrixmult(r,t);return new n(e)},residuals:function(r,t){return n.matrixsubtract(r,t)},ssr:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r,2);return t},sse:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r[e],2);return t},sst:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r,2);return t},matrixsubtract:function(r,t){for(var e=Array(r.length),o=0;o<r.length;o++){e[o]=Array(r[o].length);for(var a=0;a<r[o].length;a++)e[o][a]=r[o][a]-t[o][a]}return n(e)}}),n.jStat=n,n}()}};